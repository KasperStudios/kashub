# Исправление обработки функций

## Проблемы
1. Вызов функции конфликтует с командами
2. Return не обрабатывается
3. Аргументы не вычисляются
4. Scope не изолирован

## Решение

### 1. Изменить порядок проверки

**Было:**
```
1. Функции (определение)
2. Функции (вызов) ← Конфликт с командами!
3. Переменные
4. Команды
```

**Стало:**
```
1. Функции (определение)
2. Переменные
3. Команды ← Проверяем сначала!
4. Функции (вызов) ← Только если не команда
```

### 2. Добавить return value

Нужно:
- Добавить поле `returnValue` в ScriptInterpreter
- Обрабатывать `return` statement
- Прерывать выполнение при return
- Возвращать значение вызывающему коду

### 3. Вычислять аргументы

Использовать `evaluateExpression()` для каждого аргумента перед передачей.

### 4. Изолировать scope

Создавать новый VariableStore для каждого вызова функции.

## Реализация

См. следующий коммит с исправлениями в ScriptInterpreter.java
