# –ù–∞–π–¥–µ–Ω–Ω—ã–µ –±–∞–≥–∏ –≤ Kashub

## üî¥ –ö–†–ò–¢–ò–ß–ù–´–ï –ë–ê–ì–ò

### 1. –§—É–Ω–∫—Ü–∏–∏ - –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

#### –ü—Ä–æ–±–ª–µ–º–∞ 1.1: –í—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É–µ—Ç —Å –∫–æ–º–∞–Ω–¥–∞–º–∏
```java
// ScriptInterpreter.java:195
Matcher funcCallMatcher = FUNCTION_CALL_PATTERN.matcher(line);
if (funcCallMatcher.find()) {
    String funcName = funcCallMatcher.group(1);
    // ...
}
```

**–ë–∞–≥:** –ü–∞—Ç—Ç–µ—Ä–Ω `([a-zA-Z_][a-zA-Z0-9_]*)\\s*\\(` –º–∞—Ç—á–∏—Ç –í–°–ï, –≤–∫–ª—é—á–∞—è –∫–æ–º–∞–Ω–¥—ã!

**–ü—Ä–∏–º–µ—Ä:**
```javascript
print("Hello")  // –î—É–º–∞–µ—Ç —á—Ç–æ —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è, –∞ –Ω–µ –∫–æ–º–∞–Ω–¥–∞!
moveTo(100, 64, 200)  // –¢–æ–∂–µ!
```

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—è—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –ü–û–°–õ–ï –∫–æ–º–∞–Ω–¥, –∏–ª–∏ –ø—Ä–æ–≤–µ—Ä—è—Ç—å —á—Ç–æ —ç—Ç–æ –Ω–µ –∫–æ–º–∞–Ω–¥–∞.

---

#### –ü—Ä–æ–±–ª–µ–º–∞ 1.2: Return –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è
```java
// Execute function body
parseCommands(func.getBody());
```

**–ë–∞–≥:** `return` –Ω–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∏ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ!

**–ü—Ä–∏–º–µ—Ä:**
```javascript
fn add(a, b) {
    return a + b  // –≠—Ç–æ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è!
}
let result = add(5, 3)  // result –±—É–¥–µ—Ç undefined
```

**–†–µ—à–µ–Ω–∏–µ:** –ù—É–∂–µ–Ω –º–µ—Ö–∞–Ω–∏–∑–º –¥–ª—è return value –∏ early exit.

---

#### –ü—Ä–æ–±–ª–µ–º–∞ 1.3: –ê—Ä–≥—É–º–µ–Ω—Ç—ã –Ω–µ –≤—ã—á–∏—Å–ª—è—é—Ç—Å—è
```java
for (int j = 0; j < params.size() && j < arguments.size(); j++) {
    variables.put(params.get(j), arguments.get(j));  // –ü—Ä–æ—Å—Ç–æ —Å—Ç—Ä–æ–∫–∞!
}
```

**–ë–∞–≥:** –ê—Ä–≥—É–º–µ–Ω—Ç—ã –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –∫–∞–∫ —Å—Ç—Ä–æ–∫–∏, –Ω–µ –≤—ã—á–∏—Å–ª—è—é—Ç—Å—è!

**–ü—Ä–∏–º–µ—Ä:**
```javascript
let x = 5
let y = 3
fn add(a, b) {
    return a + b
}
add(x + 1, y * 2)  // –ü–µ—Ä–µ–¥–∞—Å—Ç "x + 1" –∏ "y * 2" –∫–∞–∫ —Å—Ç—Ä–æ–∫–∏!
```

**–†–µ—à–µ–Ω–∏–µ:** –í—ã—á–∏—Å–ª—è—Ç—å –∞—Ä–≥—É–º–µ–Ω—Ç—ã –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–¥–∞—á–µ–π.

---

#### –ü—Ä–æ–±–ª–µ–º–∞ 1.4: Scope –Ω–µ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω
```java
// Save current variable values
Map<String, String> oldVars = new HashMap<>(variables);
// ...
// Restore variable values
variables.clear();
variables.putAll(oldVars);
```

**–ë–∞–≥:** –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –≤–∏–¥–Ω—ã —Å–Ω–∞—Ä—É–∂–∏ –¥–æ restore!

**–ü—Ä–∏–º–µ—Ä:**
```javascript
let x = 10
fn test() {
    let x = 20  // –ü–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤–Ω–µ—à–Ω–∏–π x!
    print x
}
test()
print x  // –ë—É–¥–µ—Ç 20 –≤–º–µ—Å—Ç–æ 10 (–¥–æ restore)
```

**–†–µ—à–µ–Ω–∏–µ:** –°–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–π scope –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏.

---

### 2. If/Else - –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞

#### –ü—Ä–æ–±–ª–µ–º–∞ 2.1: Else –±–ª–æ–∫ –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è
```java
// ScriptInterpreter.java:280
Matcher ifMatcher = IF_PATTERN.matcher(line);
if (ifMatcher.find()) {
    // ...
    if (evaluateCondition(condition)) {
        parseCommands(ifBlock.toString());
    }
    continue;  // –ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç else!
}
```

**–ë–∞–≥:** –ü–æ—Å–ª–µ if –±–ª–æ–∫–∞ —Å—Ä–∞–∑—É continue, else –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è!

**–ü—Ä–∏–º–µ—Ä:**
```javascript
if (false) {
    print "A"
} else {
    print "B"  // –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è!
}
```

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—è—Ç—å else –ø–æ—Å–ª–µ if –±–ª–æ–∫–∞.

---

### 3. While - –ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–µ —Ü–∏–∫–ª—ã

#### –ü—Ä–æ–±–ª–µ–º–∞ 3.1: –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è
```java
while (evaluateCondition(condition)) {
    parseCommands(whileBlock.toString());
}
```

**–ë–∞–≥:** Environment variables –Ω–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –º–µ–∂–¥—É –∏—Ç–µ—Ä–∞—Ü–∏—è–º–∏!

**–ü—Ä–∏–º–µ—Ä:**
```javascript
while ($PLAYER_HEALTH < 20) {
    eat
    wait 2000
    // $PLAYER_HEALTH –≤—Å—ë –µ—â—ë —Å—Ç–∞—Ä–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ!
}
```

**–†–µ—à–µ–Ω–∏–µ:** –û–±–Ω–æ–≤–ª—è—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥ –∫–∞–∂–¥–æ–π –ø—Ä–æ–≤–µ—Ä–∫–æ–π —É—Å–ª–æ–≤–∏—è.

---

### 4. Variables - Scope –ø—Ä–æ–±–ª–µ–º—ã

#### –ü—Ä–æ–±–ª–µ–º–∞ 4.1: Let/Const –Ω–µ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã
```java
variableStore.declareLet(varName, varValue);
variables.put(varName, varValue); // Legacy compatibility
```

**–ë–∞–≥:** –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ –¥–≤—É—Ö –º–µ—Å—Ç–∞—Ö, –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è!

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ variableStore.

---

## üü° –í–ê–ñ–ù–´–ï –ë–ê–ì–ò

### 5. Commands - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è

#### –ü—Ä–æ–±–ª–µ–º–∞ 5.1: –ö–æ–º–∞–Ω–¥—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –ø–æ—Å–ª–µ —Ñ—É–Ω–∫—Ü–∏–π
```java
// Check for function call
Matcher funcCallMatcher = FUNCTION_CALL_PATTERN.matcher(line);
if (funcCallMatcher.find()) {
    // ...
}

// Process regular commands
line = processVariables(line);
List<String> parts = parseArguments(line);
String commandName = parts.get(0).toLowerCase();
Command command = CommandRegistry.getCommand(commandName);
```

**–ë–∞–≥:** –ï—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞, –∫–æ–¥ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è –∏ –ø—ã—Ç–∞–µ—Ç—Å—è –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–∞–∫ –∫–æ–º–∞–Ω–¥—É!

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—è—Ç—å –∫–æ–º–∞–Ω–¥—ã –ü–ï–†–ï–î —Ñ—É–Ω–∫—Ü–∏—è–º–∏.

---

### 6. GUI - ModernTextArea

#### –ü—Ä–æ–±–ª–µ–º–∞ 6.1: –ö—É—Ä—Å–æ—Ä —Ç–µ—Ä—è–µ—Ç—Å—è –ø—Ä–∏ —Å–∫—Ä–æ–ª–ª–µ
```java
// ModernTextArea.java
// –ù–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∫—É—Ä—Å–æ—Ä–∞ —Å–æ —Å–∫—Ä–æ–ª–ª–æ–º
```

**–ë–∞–≥:** –ü—Ä–∏ —Å–∫—Ä–æ–ª–ª–µ –∫—É—Ä—Å–æ—Ä –æ—Å—Ç–∞—ë—Ç—Å—è –Ω–∞ —Å—Ç–∞—Ä–æ–π –ø–æ–∑–∏—Ü–∏–∏ –≤–∏–∑—É–∞–ª—å–Ω–æ.

**–†–µ—à–µ–Ω–∏–µ:** –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—Ç—å –ø–æ–∑–∏—Ü–∏—é –∫—É—Ä—Å–æ—Ä–∞ –ø—Ä–∏ —Å–∫—Ä–æ–ª–ª–µ.

---

#### –ü—Ä–æ–±–ª–µ–º–∞ 6.2: –í—ã–¥–µ–ª–µ–Ω–∏–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å Shift+Arrow
```java
// –ù–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ Shift+Arrow –¥–ª—è –≤—ã–¥–µ–ª–µ–Ω–∏—è
```

**–ë–∞–≥:** Shift+Arrow –Ω–µ –≤—ã–¥–µ–ª—è–µ—Ç —Ç–µ–∫—Å—Ç.

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É Shift –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞.

---

### 7. Hot-Reload - Race Conditions

#### –ü—Ä–æ–±–ª–µ–º–∞ 7.1: Reload –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
```java
// ScriptTask.java
public void reload(String newCode) {
    this.code = newCode;
    // –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —á—Ç–æ —Å–∫—Ä–∏–ø—Ç –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è!
}
```

**–ë–∞–≥:** Reload –º–æ–∂–µ—Ç –ø—Ä–æ–∏–∑–æ–π—Ç–∏ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã!

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—è—Ç—å state –ø–µ—Ä–µ–¥ reload.

---

## üü¢ MINOR –ë–ê–ì–ò

### 8. Error Messages - –ù–µ–∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ

#### –ü—Ä–æ–±–ª–µ–º–∞ 8.1: –ù–µ—Ç –Ω–æ–º–µ—Ä–æ–≤ —Å—Ç—Ä–æ–∫ –≤ –æ—à–∏–±–∫–∞—Ö
```java
LOGGER.warn("Function not found: {}", funcName);
```

**–ë–∞–≥:** –ù–µ –ø–æ–Ω—è—Ç–Ω–æ –≥–¥–µ –æ—à–∏–±–∫–∞ –≤ –∫–æ–¥–µ!

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–º–µ—Ä —Å—Ç—Ä–æ–∫–∏ –≤ —Å–æ–æ–±—â–µ–Ω–∏—è.

---

### 9. Memory Leaks - –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —É—Ç–µ—á–∫–∏

#### –ü—Ä–æ–±–ª–µ–º–∞ 9.1: Functions –Ω–µ –æ—á–∏—â–∞—é—Ç—Å—è
```java
private final Map<String, Function> functions = new HashMap<>();
```

**–ë–∞–≥:** –§—É–Ω–∫—Ü–∏–∏ –Ω–∞–∫–∞–ø–ª–∏–≤–∞—é—Ç—Å—è –∏ –Ω–µ —É–¥–∞–ª—è—é—Ç—Å—è!

**–†–µ—à–µ–Ω–∏–µ:** –û—á–∏—â–∞—Ç—å –ø—Ä–∏ reload/stop.

---

## üìù –ü–ª–∞–Ω –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (–°–µ–π—á–∞—Å) - ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û
1. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø–æ—Ä—è–¥–æ–∫ –ø—Ä–æ–≤–µ—Ä–∫–∏ (–∫–æ–º–∞–Ω–¥—ã ‚Üí —Ñ—É–Ω–∫—Ü–∏–∏) - DONE
2. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å return value –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–π - DONE
3. ‚úÖ –í—ã—á–∏—Å–ª—è—Ç—å –∞—Ä–≥—É–º–µ–Ω—Ç—ã —Ñ—É–Ω–∫—Ü–∏–π - DONE
4. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å if/else –æ–±—Ä–∞–±–æ—Ç–∫—É - DONE
5. ‚úÖ –û–±–Ω–æ–≤–ª—è—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ while - DONE
6. ‚úÖ –ò–∑–æ–ª–∏—Ä–æ–≤–∞—Ç—å scope —Ñ—É–Ω–∫—Ü–∏–π - DONE

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (–°–ª–µ–¥—É—é—â–∞—è –∏—Ç–µ—Ä–∞—Ü–∏—è) - ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û
1. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å GUI –∫—É—Ä—Å–æ—Ä - DONE (–¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã—Ö –≥—Ä–∞–Ω–∏—Ü)
2. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å Shift+Arrow –≤—ã–¥–µ–ª–µ–Ω–∏–µ - DONE (—É–∂–µ –±—ã–ª–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)
3. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å hot-reload race conditions - DONE (–¥–æ–±–∞–≤–ª–µ–Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è)

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3 (–ü–æ—Ç–æ–º) - ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û
1. ‚úÖ –£–ª—É—á—à–∏—Ç—å error messages - DONE (–Ω–æ–º–µ—Ä–∞ —Å—Ç—Ä–æ–∫ —É–∂–µ –±—ã–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã)
2. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å memory leaks - DONE (–¥–æ–±–∞–≤–ª–µ–Ω–∞ –æ—á–∏—Å—Ç–∫–∞ functions/variables –ø—Ä–∏ stop)
3. ‚¨ú –î–æ–±–∞–≤–∏—Ç—å unit tests

---

## üß™ –¢–µ—Å—Ç–æ–≤—ã–µ —Å–ª—É—á–∞–∏

### –§—É–Ω–∫—Ü–∏–∏
```javascript
// –¢–µ—Å—Ç 1: –ü—Ä–æ—Å—Ç–∞—è —Ñ—É–Ω–∫—Ü–∏—è
fn greet(name) {
    print "Hello, $name!"
}
greet("Steve")
// –û–∂–∏–¥–∞–µ—Ç—Å—è: "Hello, Steve!"

// –¢–µ—Å—Ç 2: Return value
fn add(a, b) {
    return a + b
}
let result = add(5, 3)
print result
// –û–∂–∏–¥–∞–µ—Ç—Å—è: "8"

// –¢–µ—Å—Ç 3: –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤
let x = 5
fn double(n) {
    return n * 2
}
let result = double(x + 1)
print result
// –û–∂–∏–¥–∞–µ—Ç—Å—è: "12"

// –¢–µ—Å—Ç 4: Scope
let x = 10
fn test() {
    let x = 20
    print x
}
test()
print x
// –û–∂–∏–¥–∞–µ—Ç—Å—è: "20" –∑–∞—Ç–µ–º "10"

// –¢–µ—Å—Ç 5: –†–µ–∫—É—Ä—Å–∏—è
fn factorial(n) {
    if (n <= 1) {
        return 1
    }
    return n * factorial(n - 1)
}
print factorial(5)
// –û–∂–∏–¥–∞–µ—Ç—Å—è: "120"
```

### If/Else
```javascript
// –¢–µ—Å—Ç 1: –ü—Ä–æ—Å—Ç–æ–π else
if (false) {
    print "A"
} else {
    print "B"
}
// –û–∂–∏–¥–∞–µ—Ç—Å—è: "B"

// –¢–µ—Å—Ç 2: Else if
let x = 5
if (x < 0) {
    print "Negative"
} else if (x == 0) {
    print "Zero"
} else {
    print "Positive"
}
// –û–∂–∏–¥–∞–µ—Ç—Å—è: "Positive"
```

### While
```javascript
// –¢–µ—Å—Ç: –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è
let counter = 0
while (counter < 5) {
    counter++
    print counter
}
// –û–∂–∏–¥–∞–µ—Ç—Å—è: 1, 2, 3, 4, 5
```

---

**–ù–∞—á–∏–Ω–∞–µ–º –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è!** üîß
